#!/bin/bash

# Define the path to the PHP script
HOOK_DIR=$(dirname "$0")
PHP_SCRIPT="C:\xampp\htdocs\code_checker\code_checker.php"

# Find staged PHP files
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep '\.php$')

if [ -z "$STAGED_FILES" ]; then
    echo "No PHP files staged for commit."
    exit 0
fi

echo "Running OpenAI code quality check..."

# Pass staged files to the PHP script
php "$PHP_SCRIPT" $STAGED_FILES

# Check the exit code of the PHP script
if [ $? -ne 0 ]; then
    echo "❌ Commit rejected due to code quality issues."
    exit 1
fi

echo "✅ Code quality check passed."
exit 0
